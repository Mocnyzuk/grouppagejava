(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chat"],{"498a":function(t,e,n){"use strict";var s=n("23e7"),r=n("58a8").trim,a=n("c8d2");s({target:"String",proto:!0,forced:a("trim")},{trim:function(){return r(this)}})},"6af4":function(t,e,n){"use strict";var s=n("c04f"),r=n.n(s);r.a},7517:function(t,e,n){},a15b:function(t,e,n){"use strict";var s=n("23e7"),r=n("44ad"),a=n("fc6a"),i=n("a640"),o=[].join,c=r!=Object,u=i("join",",");s({target:"Array",proto:!0,forced:c||!u},{join:function(t){return o.call(a(this),void 0===t?",":t)}})},a26b:function(t,e,n){"use strict";var s=n("b9f1"),r=n.n(s);r.a},ab71:function(t,e,n){"use strict";var s=n("7517"),r=n.n(s);r.a},b9f1:function(t,e,n){},bec3:function(t,e,n){"use strict";var s=n("d2a8"),r=n.n(s);r.a},c04f:function(t,e,n){},c8d2:function(t,e,n){var s=n("d039"),r=n("5899"),a="​᠎";t.exports=function(t){return s((function(){return!!r[t]()||a[t]()!=a||r[t].name!==t}))}},c98b:function(t,e,n){"use strict";n.r(e);var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("main",{staticClass:"row"},[n("div",{staticClass:"sidebar col"},[n("h3",{staticClass:"title"},[t._v(" new conversation ")]),t._l(t.groups,(function(t){return n("ChatUsers",{key:t.group.id,attrs:{chat:t.group,participantId:t.participantId}})}))],2),n("div",{staticClass:"chats"},t._l(t.conversations,(function(t,e){return n("app-conversation",{key:e,attrs:{conversation:t}})})),1),n("div",{staticClass:"sidebar col"},[n("h3",{staticClass:"title"},[t._v("existing conversations")]),t._l(t.existingConversations,(function(t){return n("ExistingConversation",{key:t.id,attrs:{data:t}})}))],2)])},r=[],a=(n("96cf"),n("1da1")),i=n("5530"),o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"group"},[n("h4",{staticClass:"group__name",on:{click:t.toggle}},[t._v(t._s(t.chat.name))]),t.open&&t.otherUsers.length?n("ul",{staticClass:"users col"},t._l(t.otherUsers,(function(e){return n("li",{key:e.id,on:{click:function(n){return t.openConversation(e.id)}}},[n("p",[t._v(t._s(e.nickname))])])})),0):t._e(),t.open&&!t.otherUsers.length?n("div",[n("p",[t._v("No users in group")])]):t._e()])},c=[],u=(n("4de4"),n("a9e3"),{props:{chat:{type:Object,required:!0},participantId:{type:[Number,String],required:!0}},data:function(){return{open:!1,users:[]}},computed:{otherUsers:function(){var t=this;return this.users.filter((function(e){return e.id!==t.participantId}))}},methods:{toggle:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.open){e.next=4;break}t.open=!1,e.next=7;break;case 4:return e.next=6,t.fetchUsers();case 6:t.open=!0;case 7:case"end":return e.stop()}}),e)})))()},fetchUsers:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){var n,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$http.group.getParticipants(t.chat.id);case 3:n=e.sent,s=n.data,t.users=s,t.open=!0,e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](0),t.$alert.display(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})))()},openConversation:function(t){var e="/app/conversation/new/".concat(t);this.$store.state.chats.stompClient.send(e,{},JSON.stringify({participantId:this.participantId,type:"NEW"}))}}}),p=u,l=(n("a26b"),n("2877")),v=Object(l["a"])(p,o,c,!1,null,"28a257e6",null),d=v.exports,f=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"conversation col"},[n("div",{staticClass:"conversation__toolbar row"},[n("p",[t._v(" "+t._s(t.conversation.id)+" ")]),n("div",{staticClass:"row"},[n("button",{on:{click:t.openConversationSettings}},[t._v("+")]),n("button",{staticClass:"closeButton",on:{click:function(e){return t.closeConversation(t.conversation.id)}}},[t._v(" X ")])])]),n("div",{directives:[{name:"chat-scroll",rawName:"v-chat-scroll"}],staticClass:"conversation__content col"},t._l(t.conversation.content,(function(e,s){return n("div",{key:s,class:["message",{message__own:e.participantId===t.conversation.user}]},[n("h4",[t._v(t._s(t.conversation.userList[e.participantId]))]),n("p",[t._v(t._s(e.content))])])})),0),n("form",{staticClass:"row",on:{submit:function(e){return e.preventDefault(),t.sendMessage(e)}}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.message,expression:"message"}],attrs:{type:"text",required:""},domProps:{value:t.message},on:{input:function(e){e.target.composing||(t.message=e.target.value)}}}),n("button",{attrs:{type:"submit"}},[t._v("SEND")])])])},h=[],m=(n("498a"),n("2f62")),g={props:["conversation"],data:function(){return{message:""}},computed:Object(i["a"])({},Object(m["b"])({stompClient:function(t){return t.user.stompClient}})),methods:{closeConversation:function(t){this.$store.commit("chats/CLOSE_CONVERSATION",t)},sendMessage:function(){if(this.message.trim().length){var t="/app/conversation/".concat(this.conversation.id,"/sendmessage");this.$store.state.chats.stompClient.send(t,{},JSON.stringify({participantId:this.conversation.user,content:this.message,type:"CHAT"}))}this.message=""},openConversationSettings:function(){this.openModal("conversationSettings",this.conversation)}}},C=g,b=(n("6af4"),Object(l["a"])(C,f,h,!1,null,"2b29a9d6",null)),_=b.exports,w=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"group",on:{click:function(e){return t.openConversation(t.data.id)}}},[t._v(" "+t._s(t.data.name||t.displayedNames)+" ")])},x=[],O=(n("a15b"),n("d81d"),n("fb6a"),{props:{data:Object},data:function(){return{users:[]}},computed:{displayedNames:function(){var t=this.data.participants.map((function(t){return t.nickname})).join(", ");return t.length>20?t.slice(0,20)+"...":t}},methods:{openConversation:function(t){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function n(){var s,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.$http.chat.getConversationMessages(t);case 2:s=n.sent,r=s.data,e.$store.commit("chats/CREATE_CONVERSATION",r);case 5:case"end":return n.stop()}}),n)})))()}}}),k=O,j=(n("bec3"),Object(l["a"])(k,w,x,!1,null,"184601a6",null)),y=j.exports,E={components:{appConversation:_,ChatUsers:d,ExistingConversation:y},computed:Object(i["a"])({},Object(m["b"])({groups:function(t){return t.user.groups},conversations:function(t){return t.chats.conversations},existingConversations:function(t){return t.chats.existingConversations}})),created:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getExistingConversations();case 2:case"end":return e.stop()}}),e)})))()},methods:{openChatSearch:function(){this.openModal("chatSelect")},getExistingConversations:function(){this.$store.dispatch("chats/getExistingConversations")}}},N=E,S=(n("ab71"),Object(l["a"])(N,s,r,!1,null,"4e238246",null));e["default"]=S.exports},d2a8:function(t,e,n){}}]);
//# sourceMappingURL=chat.c3720df0.js.map